# 🔌 하드웨어 연결 다이어그램

## 전체 연결도

```
┌─────────────────────────────────────────────────────────────────┐
│                      라즈베리파이                                 │
│                                                                   │
│  Pin 1 (3.3V) ────┬─────────── VCC (MPU6050)                    │
│                    ├─────────── VDD (ADS1115)                    │
│                    ├─────────── VCC (토양 수분)                  │
│                    └─────────── VCC (진동 센서)                  │
│                                                                   │
│  Pin 3 (SDA)  ────┬─────────── SDA (MPU6050)                    │
│                    └─────────── SDA (ADS1115)                    │
│                                                                   │
│  Pin 5 (SCL)  ────┬─────────── SCL (MPU6050)                    │
│                    └─────────── SCL (ADS1115)                    │
│                                                                   │
│  Pin 6 (GND)  ────┬─────────── GND (MPU6050)                    │
│                    ├─────────── GND (ADS1115)                    │
│                    ├─────────── GND (토양 수분)                  │
│                    └─────────── GND (진동 센서)                  │
└─────────────────────────────────────────────────────────────────┘
                             │
                             │ I2C Bus
                             │
        ┌────────────────────┴────────────────────┐
        │                                          │
        ▼                                          ▼
┌──────────────┐                          ┌──────────────┐
│   MPU6050    │                          │   ADS1115    │
│              │                          │              │
│ 가속도계     │                          │ 4채널 ADC    │
│ 자이로스코프 │                          │              │
│              │                          │  A0 ◄────────── 토양 수분 OUT
│ I2C: 0x68    │                          │  A1 ◄────────── 진동 센서 OUT
│              │                          │  A2 (예비)
│              │                          │  A3 (예비)
└──────────────┘                          │              │
                                           │ I2C: 0x48    │
                                           └──────────────┘
```

---

## 핀 배치 (라즈베리파이 GPIO)

```
     3.3V  [ 1] [ 2]  5V
     SDA   [ 3] [ 4]  5V
     SCL   [ 5] [ 6]  GND
           [ 7] [ 8]
      GND  [ 9] [10]
           [11] [12]
           [13] [14]  GND
           [15] [16]
     3.3V  [17] [18]
           [19] [20]  GND
           [21] [22]
           [23] [24]
      GND  [25] [26]
           [27] [28]
           [29] [30]  GND
           [31] [32]
           [33] [34]  GND
           [35] [36]
           [37] [38]
      GND  [39] [40]
```

### 사용하는 핀
- **Pin 1**: 3.3V 전원 (모든 센서)
- **Pin 3**: GPIO 2 (SDA) - I2C 데이터
- **Pin 5**: GPIO 3 (SCL) - I2C 클럭
- **Pin 6**: GND (공통 접지)

---

## 센서별 상세 연결

### 1️⃣ MPU6050 (가속도계 + 자이로스코프)

```
MPU6050                라즈베리파이
┌─────────┐            ┌──────────────┐
│   VCC   │ ─────────► │ Pin 1 (3.3V) │
│   GND   │ ─────────► │ Pin 6 (GND)  │
│   SDA   │ ◄────────► │ Pin 3 (SDA)  │
│   SCL   │ ◄────────► │ Pin 5 (SCL)  │
│   AD0   │ (GND = 0x68, 3.3V = 0x69) │
└─────────┘            └──────────────┘
```

**I2C 주소**: 0x68 (기본값)

---

### 2️⃣ ADS1115 (16-bit ADC)

```
ADS1115                라즈베리파이
┌─────────┐            ┌──────────────┐
│   VDD   │ ─────────► │ Pin 1 (3.3V) │
│   GND   │ ─────────► │ Pin 6 (GND)  │
│   SDA   │ ◄────────► │ Pin 3 (SDA)  │
│   SCL   │ ◄────────► │ Pin 5 (SCL)  │
│   ADDR  │ ─────────► │ GND (0x48)   │
│         │            └──────────────┘
│   A0    │ ◄────────── 토양 수분 센서
│   A1    │ ◄────────── 진동 센서
│   A2    │ (예비)
│   A3    │ (예비)
└─────────┘
```

**I2C 주소**: 0x48 (기본값)

---

### 3️⃣ 토양 수분 센서 (Capacitive)

```
토양 수분 센서          ADS1115          라즈베리파이
┌──────────┐          ┌────────┐        ┌─────────┐
│   VCC    │ ────────►│ 3.3V   │◄───────│ Pin 1   │
│   GND    │ ────────►│ GND    │◄───────│ Pin 6   │
│   AOUT   │ ────────►│ A0     │        └─────────┘
└──────────┘          └────────┘
```

**출력**: 아날로그 (0~3.3V)
**채널**: ADS1115 A0

---

### 4️⃣ 진동 센서 (SW-420 또는 아날로그)

```
진동 센서              ADS1115          라즈베리파이
┌──────────┐          ┌────────┐        ┌─────────┐
│   VCC    │ ────────►│ 3.3V   │◄───────│ Pin 1   │
│   GND    │ ────────►│ GND    │◄───────│ Pin 6   │
│   AOUT   │ ────────►│ A1     │        └─────────┘
└──────────┘          └────────┘
```

**출력**: 아날로그 (0~3.3V)
**채널**: ADS1115 A1

---

## I2C 주소 요약

| 장치 | I2C 주소 | 확인 방법 |
|------|----------|-----------|
| MPU6050 | 0x68 (기본) 또는 0x69 | `sudo i2cdetect -y 1` |
| ADS1115 | 0x48 (기본) | `sudo i2cdetect -y 1` |

---

## 브레드보드 연결 예시

```
                    라즈베리파이
                   ┌──────────┐
                   │  1  2    │
    ┌──────────────┤  3  4    │
    │  ┌───────────┤  5  6    ├───────┐
    │  │           │  ...     │       │
    │  │           └──────────┘       │
    │  │                              │
  [SDA][SCL]                        [GND]
    │  │                              │
    ╞══╪══════════════════════════════╪══╡
    ║  │                              │  ║
    ║  │  ┌──────┐     ┌──────┐      │  ║ 브레드보드
    ║  └──┤ MPU  │     │ ADS  │──────┘  ║
    ║     │ 6050 │     │ 1115 │         ║
    ║     └──────┘     └───┬──┘         ║
    ║                      │            ║
    ║     ┌─────┐      ┌───┴─┐          ║
    ║     │토양 │      │진동 │          ║
    ║     │수분 │      │센서 │          ║
    ║     └─────┘      └─────┘          ║
    ╞═══════════════════════════════════╡
    [3.3V Rail]
```

---

## 연결 체크리스트

### 전원 연결
- [ ] 모든 센서 VCC → 라즈베리파이 3.3V
- [ ] 모든 센서 GND → 라즈베리파이 GND

### I2C 연결
- [ ] MPU6050 SDA → GPIO 2 (Pin 3)
- [ ] MPU6050 SCL → GPIO 3 (Pin 5)
- [ ] ADS1115 SDA → GPIO 2 (Pin 3)
- [ ] ADS1115 SCL → GPIO 3 (Pin 5)

### 센서 연결
- [ ] 토양 수분 OUT → ADS1115 A0
- [ ] 진동 센서 OUT → ADS1115 A1

### 주소 확인
- [ ] MPU6050: 0x68 확인 (`i2cdetect`)
- [ ] ADS1115: 0x48 확인 (`i2cdetect`)

---

## 주의사항 ⚠️

1. **전압**: 반드시 3.3V 사용 (5V 사용 시 라즈베리파이 손상 가능)
2. **접지**: 모든 GND는 공통으로 연결
3. **센서 극성**: VCC/GND 반대로 연결하지 않도록 주의
4. **I2C 풀업**: 대부분 센서 모듈에 내장됨
5. **토양 수분**: 센서 회로부는 물에 닿지 않게 주의

---

## 테스트 방법

### 1. I2C 장치 스캔
```bash
sudo i2cdetect -y 1
```

정상 연결 시:
```
     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
00:          -- -- -- -- -- -- -- -- -- -- -- -- --
10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
40: -- -- -- -- -- -- -- -- 48 -- -- -- -- -- -- --
50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
60: -- -- -- -- -- -- -- -- 68 -- -- -- -- -- -- --
70: -- -- -- -- -- -- -- --
```

### 2. 센서 테스트
```bash
cd ~/Sinker_IOT/raspberry_pi
python3 sensor_test.py
```

---

**연결 완료!** 🎉

문제가 있으면 `sensor_status.py`를 실행하여 진단하세요.
